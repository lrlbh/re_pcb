## 下次pcb_v9

- 3.5寸320x480看到一个20块，现在用的4寸320x480要28块，考虑是否替换
- POW电流的加法器推高电压时，由于是设计好了才加上的，所以180的输出走线有5厘米，虽然从电感和电阻评估都没有问题，不过不确定是否存在隐患，下次修正它，两层板则考虑删除，方便部线
- 一个多余引脚，本来应该用于获取ADC实际量程，被误删了

- 是否支持双面type-c
- 捷配现在打样规则，如果还可以大尺寸双层，则改为两层板
- 捷配打的1.085欧加热片未知原因和前几次都不同，没有焊盘是裸铜的，（现在2W导热2.0板厚二选1，6块钱可以打样）
- 加热板，如果想骑在电源上，上下螺丝孔距离需要稍微大一点点
- 如果两层板，电机孔后移一点
- 如果两层板，考虑是否留点电源散热孔
- 压力瓶颈在铝基板，6~7柱竖立用如何？
- 样品，灵星芯微有同一个50倍放大，带ref的INA213

##  下次pcb_v8

- ~~POW采样电阻换非裸漏， 0.5m有，但考虑是否合适~~

- ~~电机电流采样换 A3~~

- ~~模拟电压用3V~~

- ~~称重传感器用type-c接口~~

- ~~ADC_EN_100nf_1uf保留0402，其他磁珠，电阻，电容，全部改0603，低温锡调试其他电路时，0402容易掉了没发现~~

- 3.5寸320x480看到一个20块，现在用的4寸320x480要28块，考虑是否替换

- ~~降低热电耦放大倍数~~

- ~~热耦合SIG_2对应了K1,SIG_1对应了K2~~

- ~~加几个立式电阻，现在LDO温升较大~~

- ~~read_uv函数，是否可以知道满量程输出，如果不可以或者麻烦，考虑份出一个ADC引脚用来获取~~





# code更新

- 删除boot.py依赖
- 更多可修改参数
- 升降台每次工作只上升一次，塑料连接杆半融化崩飞情况下，避免损坏升降台
- 按键用中断
- 提供配置文件web修改
- 热压需要自动关闭

- UI区域添加默认up_data位置 “:”
- 这次的升降台，旋钮大小不一致，重新建模一个
- ~~热电偶路数，搞个参数，通过输入adc引脚确定也行~~
- 有了提供满量程实际电压的引脚，考虑是否使用
- pwm返回值改成小数
- ~~main里面捕获不到任务完整错误信息，给每个任务加个装饰器~~
- ~~每次运行的校准时机~~
- 非工作状态低频数据 or gc回收？显示？
- ~~电流放大使用的是180,180没有VREF。恰好ESP32S3使用校准读取read_uv()也总是有6~8mv左右的电压偏低，所以，需要添加这个固定误差的校准，考虑下面方式校准。~~
    - ~~1、测一下，当前单片机的误差 - 测一下180的零飘，大概需要补偿个3~4mv。~~
    - ~~2、负载直接换个电阻，测一下多少ma开始有读数就行，大概需要补偿个100ma左右~~
    - ~~3、180的输出加个运放，提高点基准，基准电压可以选择，确保25A时，adc输出小于850mv。此法可以和其他器件一样动态校准，不过需要加1~2个运放。~~
    - ~~4、直接来个0飘大一点的180,0点飘移大于ESP32S3的偏低，直接可以动态校准了，比上面好，时飘也可以被处理到。~~
    - ~~5、结合3，继续给发热片并连接一个电阻，推高基准，实际应该需要24V * 100mA = 2.4W功率浪费。~~

#  购物

~~~python
M3压热电偶的公螺头，长一点
M3垫片
M3塑料柱强度和耐热不一定够，铜柱浪费热还有导电风险
~~~





# 遇到的问题

## ~~压力持续下降~~

### ~~怀疑~~

- ~~首先最怀疑是塑料连接件问题~~
- ~~其次缓冲材料发热后缩小？铝基板变型？不太可能~~
- ~~最后，工作噪声，温漂等，如果是这个情况，那么焊接时也应该发生，但没有发生过，在测试下~~

### ~~解决~~

~~1、仪表输入两个脱敏电容没焊情况下，在PWM=100%时，克数飘移变大了100克，其他占空比时正常，比较奇怪。已经安装懒得查原因了，脱敏电容应该不需要那么大，下次上两个C0G完事了。或者下次新板子查查看。~~

~~2、热压时还是点有轻微的缓慢压力降低，对比焊接模式并没有什么显著的热传导路径，应该就是这几十个塑料柱子大问题，两个高温海绵小问题。~~





# 杂记录

ref调低点





~~~PY
# RRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRR测试
# 可调电源输入20V，PWM == 50%，情况下
# 传感器噪声: 稳定段标准差² × 3~5倍
【第 4600 个新点】当前窗口标准差（最近 300 点）:
   原始温度  → 标准差 = 0.5358 °C
   众数滤波  → 标准差 = 0.0000 °C
   卡尔曼滤波 → 标准差 = 0.1210 °C  ← 推荐关注
   卡尔曼衰减倍数 ≈ 4.4 倍


【第 4700 个新点】当前窗口标准差（最近 300 点）:
   原始温度  → 标准差 = 0.5327 °C
   众数滤波  → 标准差 = 0.0000 °C
   卡尔曼滤波 → 标准差 = 0.0617 °C  ← 推荐关注
   卡尔曼衰减倍数 ≈ 8.6 倍


【第 4800 个新点】当前窗口标准差（最近 300 点）:
   原始温度  → 标准差 = 0.5162 °C
   众数滤波  → 标准差 = 0.0347 °C
   卡尔曼滤波 → 标准差 = 0.0275 °C  ← 推荐关注
   卡尔曼衰减倍数 ≈ 18.7 倍



>>> 0.5327 ** 2 * 3
>>> 0.8513078699999999

R = 0.8513078699999999
~~~



~~~python
# QQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQ 测试
# 20V,1.7欧姆加热板 60~80度，每秒大约变化0.6度
# 两次测量最大变化速度: (相邻两次合理最大温差)² × 0.2~0.5
>>> 0.6 / (1000 / 20)	# 假设最大间隔20ms
0.012

>>> 0.012 ** 2 * 0.3
4.32e-05

~~~

